---
title: "World Bank Data"
subtitle: "Week 03, Day 1; Homework"
author: "Miles Drake"
date: "2020-04-02"
output:
  html_document:
    df_print: paged
    number_sections: true
    toc: true
    toc_float: true
---



<pre class="r"><code>library(janitor)
library(tidyverse)
library(outliers)</code></pre>
<div id="mvp" class="section level1">
<h1>MVP</h1>
<div id="section" class="section level2">
<h2></h2>
<pre class="r"><code>women &lt;- read_csv(&quot;data/women_in_gov.csv&quot;, skip = 4)</code></pre>
</div>
<div id="section-1" class="section level2">
<h2></h2>
<pre class="r"><code>women &lt;- rename(
  women,
  &quot;country_name&quot; = &quot;Country Name&quot;,
  &quot;country_code&quot; = &quot;Country Code&quot;,
  &quot;indicator_name&quot; = &quot;Indicator Name&quot;,
  &quot;indicator_code&quot; = &quot;Indicator Code&quot;
)</code></pre>
</div>
<div id="section-2" class="section level2">
<h2></h2>
<pre class="r"><code>unique(women$indicator_name)</code></pre>
<pre><code>## [1] &quot;Proportion of seats held by women in national parliaments (%)&quot;</code></pre>
<pre class="r"><code>unique(women$indicator_code)</code></pre>
<pre><code>## [1] &quot;SG.GEN.PARL.ZS&quot;</code></pre>
<pre class="r"><code>unique(women$X64)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>women &lt;- select(
  women,
  -indicator_name,
  -indicator_code,
  -X64
)</code></pre>
</div>
<div id="section-3" class="section level2">
<h2></h2>
<pre class="r"><code>women &lt;- pivot_longer(
  women,
  cols = &quot;1960&quot;:&quot;2018&quot;,
  names_to = &quot;year&quot;,
  values_to = &quot;percent&quot;
)</code></pre>
</div>
<div id="section-4" class="section level2">
<h2></h2>
<pre class="r"><code>women_na &lt;- women %&gt;% 
  filter(
    is.na(percent)
  )</code></pre>
<pre class="r"><code>unique(women_na$percent)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>sum(
  is.na(women_na$percent)
)</code></pre>
<pre><code>## [1] 10466</code></pre>
<pre class="r"><code>women &lt;- women %&gt;% 
  filter(
    !is.na(percent)
  )</code></pre>
<pre class="r"><code>women</code></pre>
<pre><code>## # A tibble: 5,110 x 4
##    country_name country_code year  percent
##    &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt;
##  1 Afghanistan  AFG          1990      3.7
##  2 Afghanistan  AFG          2005     27.3
##  3 Afghanistan  AFG          2006     27.3
##  4 Afghanistan  AFG          2007     27.7
##  5 Afghanistan  AFG          2008     27.7
##  6 Afghanistan  AFG          2009     27.3
##  7 Afghanistan  AFG          2010     27.7
##  8 Afghanistan  AFG          2011     27.7
##  9 Afghanistan  AFG          2012     27.7
## 10 Afghanistan  AFG          2013     27.7
## # ... with 5,100 more rows</code></pre>
</div>
<div id="section-5" class="section level2">
<h2></h2>
<pre class="r"><code>ggplot(women) +
  aes(y = percent) +
  geom_boxplot()</code></pre>
<p><img src="/week-03/day-2/1-world-bank-data_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>women &lt;- women %&gt;%
  mutate(
    zscore = scores(percent),
    is_outlier = zscore &lt; -3 | zscore &gt; 3,
    zscore = round(zscore, 2)
  )</code></pre>
<pre class="r"><code>filter(
  women,
  is_outlier
)</code></pre>
<pre><code>## # A tibble: 35 x 6
##    country_name country_code year  percent zscore is_outlier
##    &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;     
##  1 Andorra      AND          2011     50     3.27 TRUE      
##  2 Andorra      AND          2012     50     3.27 TRUE      
##  3 Andorra      AND          2013     50     3.27 TRUE      
##  4 Andorra      AND          2014     50     3.27 TRUE      
##  5 Bolivia      BOL          2014     53.1   3.57 TRUE      
##  6 Bolivia      BOL          2015     53.1   3.57 TRUE      
##  7 Bolivia      BOL          2016     53.1   3.57 TRUE      
##  8 Bolivia      BOL          2017     53.1   3.57 TRUE      
##  9 Bolivia      BOL          2018     53.1   3.57 TRUE      
## 10 Cuba         CUB          2013     48.9   3.16 TRUE      
## # ... with 25 more rows</code></pre>
</div>
<div id="section-6" class="section level2">
<h2></h2>
<p>Rwanda and Bolivia are famous for having lower houses of parliament where more than 50 per cent of the chamber are female deputies. These outliers are <em>valid</em> data, but they make visual analysis of the rest of the world more difficult. It is, arguably, worth removing Rwanda and Bolivia from the data set to focus on the rest of the world.</p>
<pre class="r"><code>women_row &lt;- women %&gt;%
  filter(
    !(country_code %in% c(&quot;BOL&quot;, &quot;RWA&quot;))
  )</code></pre>
</div>
<div id="section-7" class="section level2">
<h2></h2>
<pre class="r"><code>women_row_mean &lt;- women_row %&gt;% 
  group_by(country_name) %&gt;% 
  summarise(
    mean_percent = mean(percent)
  ) %&gt;% 
  arrange(
    desc(mean_percent)
  )</code></pre>
<pre class="r"><code>head(women_row_mean, 10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    country_name mean_percent
##    &lt;chr&gt;               &lt;dbl&gt;
##  1 Sweden               44.2
##  2 Finland              38.9
##  3 Cuba                 38.8
##  4 Norway               38  
##  5 Denmark              37.4
##  6 Netherlands          36.7
##  7 Iceland              35.8
##  8 South Africa         34.6
##  9 Mozambique           34.0
## 10 Argentina            33.5</code></pre>
<pre class="r"><code>tail(women_row_mean, 10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    country_name          mean_percent
##    &lt;chr&gt;                        &lt;dbl&gt;
##  1 Nauru                        2.39 
##  2 Tonga                        1.82 
##  3 Vanuatu                      1.74 
##  4 Papua New Guinea             1.39 
##  5 Palau                        1.14 
##  6 Oman                         1.12 
##  7 Solomon Islands              1.05 
##  8 Qatar                        0.754
##  9 Yemen, Rep.                  0.509
## 10 Micronesia, Fed. Sts.        0</code></pre>
</div>
<div id="section-8" class="section level2">
<h2></h2>
<p>Which countries have had the greatest change in proportion of women deputies for between their earliest and latest recorded dates?</p>
<pre class="r"><code>women_row_change &lt;- women_row %&gt;% 
  arrange(
    country_name,
    year
  ) %&gt;% 
  group_by(country_name) %&gt;% 
  mutate(
    diff = percent - lag(percent)
  ) %&gt;% 
  summarise(
    cum_diff = sum(diff, na.rm = TRUE)
  ) %&gt;% 
  mutate(
    cum_diff = round(cum_diff, 2)
  ) %&gt;% 
  arrange(
    desc(cum_diff)
  )</code></pre>
<pre class="r"><code>head(women_row_change, 10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    country_name   cum_diff
##    &lt;chr&gt;             &lt;dbl&gt;
##  1 South Africa       39.5
##  2 Namibia            39.3
##  3 Ethiopia           36.8
##  4 Mexico             36.2
##  5 Costa Rica         35.1
##  6 Macedonia, FYR     35  
##  7 Ecuador            33.5
##  8 France             32.7
##  9 Argentina          32.6
## 10 Nicaragua          30.9</code></pre>
<pre class="r"><code>tail(women_row_change, 10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    country_name              cum_diff
##    &lt;chr&gt;                        &lt;dbl&gt;
##  1 Mali                          -3.4
##  2 Yemen, Rep.                   -4.1
##  3 Vanuatu                       -4.3
##  4 Korea, Dem. Peopleâ€™s Rep.     -4.8
##  5 Guyana                        -5  
##  6 Guinea-Bissau                 -6.3
##  7 Mongolia                      -7.8
##  8 Hungary                       -8.1
##  9 Romania                      -13.7
## 10 Armenia                      -17.5</code></pre>
</div>
</div>
